{% extends 'base.html.twig' %}

{% block title %}Blog - Entr'Aide 2.0
{% endblock %}

{% block body %}
	<div
		class="container mt-5">
		<!-- En-tête avec couleur verte -->
		<div class="d-flex justify-content-between align-items-center mb-5">
			<h1 class="display-4 font-weight-bold text-success position-relative">
				<span class="position-absolute h-100 bg-success start-0 top-0" style="width: 4px;"></span>
				<span class="ms-3">Blog Entr'Aide</span>
			</h1>
			<a href="{{ path('app_blog_new') }}" class="btn btn-success btn-lg d-none d-md-inline-block">
				<i class="bi bi-plus-circle me-2"></i>Nouvel article
			</a>
		</div>

		<!-- Bouton flottant vert -->
		<div class="d-block d-md-none fixed-bottom text-end mb-3 me-3">
			<a href="{{ path('app_blog_new') }}" class="btn btn-success btn-lg rounded-circle shadow-lg" style="width: 56px; height: 56px;">
				<i class="bi bi-plus-circle fs-4"></i>
			</a>
		</div>

		<!-- Barre de recherche verte -->
		<div class="card mb-4 border-0 bg-light-green overflow-hidden">
			<div class="card-body p-0">
				{{ form_start(searchForm, {'attr': {'class': 'input-group bg-transparent'}}) }}
				{{ form_widget(searchForm.query, {'attr': {
                    'class': 'form-control border-0 py-3 px-4',
                    'placeholder': 'Rechercher un article...'
                }}) }}
				<button type="submit" class="btn btn-success px-4 rounded-0">
					<i class="bi bi-search fs-5"></i>
				</button>
				{{ form_end(searchForm) }}
			</div>
		</div>

		<!-- Message de recherche vert -->
		{% if searchQuery %}
			<div class="alert alert-success mb-4 rounded-pill d-flex align-items-center shadow-sm">
				<div class="flex-grow-1">
					Résultats pour :
					<strong>"{{ searchQuery }}"</strong>
				</div>
				<a href="{{ path('app_blog_index') }}" class="btn btn-link text-decoration-none p-0">
					<i class="bi bi-x-circle me-1"></i>Effacer
				</a>
			</div>
		{% endif %}

		<!-- Grille d'articles avec accents verts -->
		<div class="row g-4">
			{% for post in posts %}
				<div class="col-12 col-md-6 col-lg-4">
					<div
						class="card h-100 border-0 shadow-hover transition-all">
						<!-- Image avec dégradé vert -->
						<div class="card-img-top position-relative overflow-hidden" style="height: 200px;">
							{% if post.imageName %}
								<img src="{{ asset('uploads/blog/' ~ post.imageName) }}" alt="{{ post.title }}" class="w-100 h-100 object-fit-cover">
							{% else %}
								<div class="w-100 h-100 bg-success d-flex align-items-center justify-content-center">
									<i class="bi bi-card-image fs-1 text-light opacity-25"></i>
								</div>
							{% endif %}
						</div>

						<div class="card-body">
							<div class="d-flex align-items-center mb-3">
								<div class="badge bg-success bg-opacity-10 text-success rounded-pill me-2">
									Catégorie
								</div>
								<small class="text-muted">{{ post.createdAt|date('d/m/Y') }}</small>
							</div>
							<h3 class="h5 card-title">{{ post.title }}</h3>
							<p class="card-text text-muted mb-3">{{ post.content|slice(0, 120)|trim }}...</p>
							<div class="d-flex justify-content-between align-items-center">
								<a href="{{ path('app_blog_show', {'slug': post.slug}) }}" class="btn btn-link text-success text-decoration-none p-0 stretched-link">
									Lire la suite
									<i class="bi bi-arrow-right ms-2 transition-all"></i>
								</a>
								<div class="d-flex align-items-center text-muted">
									<i class="bi bi-person-circle me-2"></i>
									<small>{{ post.author.pseudo }}</small>
								</div>
							</div>
						</div>
					</div>
				</div>
			{% else %}
				<div class="col-12">
					<div class="alert alert-success rounded-3 shadow-sm">
						<i class="bi bi-info-circle me-2"></i>Aucun article disponible pour le moment
					</div>
				</div>
			{% endfor %}
		</div>
	</div>

	<style>
		/* Personnalisation des couleurs */
		.bg-light-green {
			background-color: #f0faf5;
		}

		.shadow-hover {
			transition: transform 0.3s ease, box-shadow 0.3s ease;
			box-shadow: 0 0.5rem 1rem rgba(40, 167, 69, 0.05);
		}

		.shadow-hover:hover {
			transform: translateY(-5px);
			box-shadow: 0 1rem 2rem rgba(40, 167, 69, 0.1);
		}

		.transition-all {
			transition: all 0.3s ease;
		}

		.btn-link:hover .bi-arrow-right {
			transform: translateX(3px);
		}

		.card-img-top {
			background: linear-gradient(45deg, #2b8a3e, #37b24d);
		}
	</style>
{% endblock %}
