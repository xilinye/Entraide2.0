<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<title>
			{% block title %}Entr'Aide 2.0
			{% endblock %}
		</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>
		<link rel="stylesheet" href="{{ asset('styles/app.css') }}"/> {% block stylesheets %}{% endblock %}
		</head>
		<body class="bg-light">
			<nav class="navbar navbar-expand-lg navbar-dark fixed-top shadow-sm" style="background: linear-gradient(145deg, #2E7D32, #43A047);
																												box-shadow: 0 2px 15px rgba(0,0,0,0.1);">
				<div class="container">
					<a class="navbar-brand fw-bold d-flex align-items-center" href="{{ path('app_page_home') }}">
						<i class="bi bi-people-fill me-2"></i>
						Entr'Aide 2.0
					</a>

					<button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
						<span class="navbar-toggler-icon"></span>
					</button>

					<div class="collapse navbar-collapse" id="navbarContent">
						<ul
							class="navbar-nav ms-auto mb-2 mb-lg-0 gap-lg-2">
							<!-- Liens principaux -->
							<li class="nav-item">
								<a class="nav-link d-flex align-items-center position-relative px-3" href="{{ path('app_page_about') }}">
									<i class="bi bi-info-circle me-2"></i>
									À propos
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link d-flex align-items-center position-relative px-3" href="{{ path('app_page_contact') }}">
									<i class="bi bi-envelope me-2"></i>
									Contact
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link d-flex align-items-center position-relative px-3" href="{{ path('app_page_terms') }}">
									<i class="bi bi-file-text me-2"></i>
									Conditions
								</a>
							</li>

							{% if is_granted('ROLE_USER') %}
								<!-- Menu utilisateur -->
								<li class="nav-item dropdown">
									<a class="nav-link dropdown-toggle d-flex align-items-center px-3" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
										<i class="bi bi-person-circle me-2"></i>
										Mon espace
									</a>
									<ul class="dropdown-menu dropdown-menu-end shadow">
										<li>
											<a class="dropdown-item" href="{{ path('app_profile_index') }}">Profil</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_search_index') }}">Recherche</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_message_index') }}">Messagerie</a>
										</li>
										<li><hr class="dropdown-divider"></li>
										<li>
											<a class="dropdown-item" href="{{ path('app_blog_index') }}">Blog</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_forum_index') }}">Forum</a>
										</li>
										<li>
											<a class="dropdown-item" href="{{ path('app_event_index') }}">Événements</a>
										</li>
									</ul>
								</li>

								{% if is_granted('ROLE_ADMIN') %}
									<li class="nav-item">
										<a class="nav-link text-warning fw-bold d-flex align-items-center position-relative px-3" href="{{ path('app_admin_dashboard') }}">
											<i class="bi bi-shield-lock me-2"></i>
											Admin
											<span class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle">
												<span class="visually-hidden">Accès admin</span>
											</span>
										</a>
									</li>
								{% endif %}
							{% endif %}

							<!-- Section authentification -->
							<li class="nav-item dropdown ms-lg-2">
								{% if is_granted('ROLE_USER') %}
									<a class="nav-link btn btn-outline-light hover-scale py-2 px-3 rounded-pill" href="{{ path('app_logout') }}">
										<i class="bi bi-box-arrow-right me-2"></i>
										Déconnexion
									</a>
								{% else %}
									<a class="nav-link btn btn-light text-dark hover-scale py-2 px-3 rounded-pill" href="{{ path('app_login') }}">
										<i class="bi bi-box-arrow-in-right me-2"></i>
										Connexion
									</a>
								{% endif %}
							</li>
						</ul>
					</div>
				</div>
			</nav>

			<style>
				.navbar {
					transition: all 0.3s ease;
					padding-top: 0.5rem;
					padding-bottom: 0.5rem;
				}

				.nav-link {
					transition: all 0.2s ease;
					border-radius: 0.5rem;
					color: rgba(255, 255, 255, 0.85) !important;
				}

				.nav-link:hover,
				.nav-link:focus {
					color: white !important;
					background: rgba(255, 255, 255, 0.15);
					transform: translateY(-1px);
				}

				.nav-link::after {
					content: '';
					position: absolute;
					bottom: 0;
					left: 50%;
					width: 0;
					height: 2px;
					background: white;
					transition: all 0.3s ease;
				}

				.nav-link:hover::after {
					width: 60%;
					left: 20%;
				}

				.dropdown-menu {
					border: none;
					background: rgba(255, 255, 255, 0.95);
				}

				.dropdown-item {
					transition: all 0.2s ease;
				}

				.dropdown-item:hover {
					background: #f8f9fa;
					transform: translateX(5px);
				}

				.hover-scale {
					transition: transform 0.2s ease;
				}

				.hover-scale:hover {
					transform: scale(1.05);
				}

				.navbar-toggler:focus {
					box-shadow: none !important;
				}

				.nav-link.text-warning {
					color: #ffc107 !important;
				}

				.nav-link.text-warning:hover {
					color: #ffda6a !important;
					background: rgba(255, 193, 7, 0.15);
				}

				.nav-link .rounded-circle {
					width: 8px;
					height: 8px;
					font-size: 0;
				}
			</style>

			<div class="container mt-5 pt-5">
				{% for type, messages in app.flashes %}
					{% for message in messages %}
						<div class="alert alert-{{ type }} alert-dismissible fade show" role="alert">
							{{ message }}
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					{% endfor %}
				{% endfor %}
			</div>

			<main class="container my-5"> {% block body %}{% endblock %}
				</main>

				<footer class="bg-dark text-white mt-5 py-4">
					<div class="container text-center">
						<p>&copy;
							{{ 'now'|date('Y') }}
							Entr'Aide 2.0 - Tous droits réservés</p>
					</div>
				</footer>

				<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
				<div id="cookieConsent" class="alert alert-dark fixed-bottom m-3 d-none">
					<div class="d-flex gap-3 align-items-center">
						<i class="bi bi-cookie fs-4"></i>
						<div>
							Nous utilisons des cookies essentiels au fonctionnement.
							<a href="{{ path('app_page_privacy') }}" class="alert-link">En savoir plus</a>
						</div>
						<button class="btn btn-sm btn-primary ms-auto" onclick="hideConsent()">Accepter</button>
					</div>
				</div>

				<script>
					document.addEventListener('DOMContentLoaded', function () {
if (!localStorage.getItem('cookieConsent')) {
document.getElementById('cookieConsent').classList.remove('d-none');
}
});

function hideConsent() {
localStorage.setItem('cookieConsent', 'true');
document.getElementById('cookieConsent').classList.add('d-none');
}
				</script>
				{% block javascripts %}
					<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
					<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
					<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
					<script>
						$(document).ready(function () {
$('.select2-multiple').select2({placeholder: 'Choisissez vos compétences...', allowClear: true, width: '100%'});
});
					</script>
				{% endblock %}
			</body>
		</html>
